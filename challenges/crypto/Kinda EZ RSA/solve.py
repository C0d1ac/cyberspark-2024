'''
This challenge was not supposed to be solved through Wiener attack but actually was solvable through that attack.Here is an easy implementation of Wiener's attack to solve this challenge.

'''



import owiener
from Crypto.Util.number import long_to_bytes
import re
N = 0x9857550a7d4fad45a2a1b354bfd33c2d5912749e7f396ab36f891b7506db41e61f70a216e6421315987f8cc0b5bf6d5f81785aa908690ea3c2671001dc23eb0bca59afaee798ab4e7feda4df474f372e9927bd5d7b855af3a209908d2baad72b8c5c7fde465d155844cffd38585ad9aeb7e430561992ff543d55d3839901c0d713cce88e8880700428261e10e1cd90f5694a6ef16a3a1f61aa73f1666b60e4e83ab605c11234e429090e4ae4c5f0c761115710305648fe5890d88e0e50ff73993fce9165005c7d07e9d7446b1fa6b28acc55047f5b403f5318aa7b21bc1cd6a668d4455a473861e8f693518d1fbf36dfb2e2466c4cc194a6cded7d173f4ad073
e = 0x693ff9dd4a34f6a3cc80403f777882e73716db11684dea651be2e31c71ff480cdc30e0e6a14b74aef85f1afb4fe20d953806ca7c588818d94b47a16441d512c6ba1f922b3569d799fc98fa641a244f4960eeac517f993152a6da7ca3b9226466437e5bd1e94d56b6ce7216f09719b76cef341e5b0da9f6b35cc171404e575d6811a4bd90f8b250f75ec7411c6f7576f2fc9a4060554330abc307540e15cdea3b7416f185dee4b7359cee7d970059357d47c2718987804f41fd8507646fd510a1a2ef3e1adf7e7bdd7ed8a2a923dee116d6a20d589a716b8ad7cd2bd3171c6e2f0448e09b02fbdc3e25957b8d84805b95ba131468e6774baa1e0b7522f05d42d3
c = 0xb1cb17d7e9dd7b4f9c31392201d0da9586fccc6b033f918e2defe36082fb7c4d205614f3e7fc1eed03a950b04a74a958198e19f91f377c1bdce8f01e0dcc1d120e4d9f7ef9c7e329ca87a26364ee58a019ce4f42836e8ebe86fe05e1704de8f016c5322fd991bda5975e10828f531fa0ce0520a9c4539cf4626c6a19326d9d7bcbb179deb6f8c10f74a7e21fa0c1f044c9fc6144f3e46e3bda23f0385bf24e460ad43c5f7d14976ab75f98b1091c48d072c1129db50232d562e0e82b6373cceeb3a7eb895a87d120a1c2c5bd71420a77d0c86b2ac7364ee1e3702ea784409cf820008544dba21b1f967d6fda1ca3fc1885e7f24852d837b698ed17ad8db2888
N = int(N)
e = int(e)
c = int(c)
#--------Wiener's attack--------#

d = owiener.attack(e, N)

if d:
    m = pow(c, d, N)
    flag = long_to_bytes(m)
    flag = re.findall(r'Spark{.*?}', flag.decode(errors="ignore"))[0]
    print(flag)
else:
    print("Wiener's Attack failed.")



'''
Or u can use RsaCtfTool and get the flag directly using this command : 
quiiper@quipper:~/Desktop/RsaCtfTool$ ./RsaCtfTool.py -n 19231287463432981177041922352411225821385975940550973416304632596100566583527327677376401885453855999497740972805518591982634761211837827496296547266337165533218820394086039134519614487289508801275456279786881342284776146947887234460355291238744472175617803243628751387634692436868636417887922174111702191863127033302915768031045168429577947854208810256149404679559310603114894325851974640732631667998961340415968384829147579703797907365263230564174565952805800675855414549344692537040188023641199257166160498740183811748075773972784552552927866282411104630406682642222884307400598862723911504856090981868404847857779 -e 13286569779043140810602623622318318437349726963451207384748787678381309247235012609568926831260229235134025374236516175562930664583875508406089652453321048749448132188619087554784320942021840380240976513562436292546424463969667303708260076896304956721392340900724600053670871536013571471382732633919313740127286511121872329209649142217509048652472799603490726898016650119984946342348795604078838325834637693251147315271162706358612554927606675561957659223173152005498127286631022759263006365190249005596504884519246511884086085630316994179264366244077773783656363811444700505535626990453650428064797474267321222382291 --decrypt 1402770558631579820465381006596645066170914892940400047858943424013635012826443092551582275335579998890352565179137769348911806425118080533621617680601597012677546121283693312807684369259269937704516620110246756792445602676204563939024722683565261461065883305870732094509481906961672832119263531530374587205364126576135154394905139525401770634694267088035839324270872216144767609301990177135221270454238322335075406772514447739826507140600580240108808665634089150713045560481240251390676202720389785039106770706620188736481643343233376610838127952851316962536760965978722144428517735204107898100937878610857537775752 --attack wiener
private argument is not set, the private key will not be displayed, even if recovered.
['/tmp/tmph9lazgvk']

[*] Testing key /tmp/tmph9lazgvk.
[*] Performing wiener attack on /tmp/tmph9lazgvk.
 24%|███████████████████████████████████████▉                                                                                                                               | 298/1247 [00:00<00:00, 350800.62it/s]
[*] Attack success with wiener method !

Results for /tmp/tmph9lazgvk:

Decrypted data :
HEX : 0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000537061726b7b616234623566386138373934313165353536353930383836663238303930666139393061616130667d
INT (big endian) : 50165763545852250561014172728608007355494789155487882569935879887862282401748926954317161761616266680668827707005
INT (little endian) : 15830179387816222947568303748870814114302156957754792530371739757095819261833277310298052742121730142841206184678145662367832394099985540469091181948411491169207811513012582533566102265361061064921646263599004210769792876816103865160910984482691951142732435723123228375931326584339414115234477887527157363697987572871627851624006392772278427055281632343145185293407835024371515327881213003365742631520099408340299813841536905549985129614625001102257912965117692776414816716215549201668580961617519468909241577147249105793907094474231708862704368056508060110151254008704257969357118085444711693995247953907370405396480
utf-8 : Spark{ab4b5f8a879411e556590886f28090fa990aaa0f}
utf-16 : 匀慰歲慻㑢㕢㡦㡡㤷ㄴ攱㔵㔶〹㠸昶㠲㤰昰㥡〹慡ち給
STR : b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00Spark{ab4b5f8a879411e556590886f28090fa990aaa0f}'

'''

#flag : Spark{ab4b5f8a879411e556590886f28090fa990aaa0f}